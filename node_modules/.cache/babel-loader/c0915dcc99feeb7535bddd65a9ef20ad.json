{"ast":null,"code":"var _jsxFileName = \"/home/santiago/Trybe/myprojects/sd-09-project-trivia-react-redux/src/pages/trivia.js\";\nimport React from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { PropTypes } from 'prop-types';\nimport Header from '../components/header';\nimport { getQuestions, setNext, setSelectedAnswer } from '../redux/actions';\nimport Question from '../components/question';\n\nclass trivia extends React.Component {\n  constructor(pro) {\n    super(pro);\n    this.state = {\n      index: 0,\n      loading: true,\n      answered: false,\n      time: 30,\n      disabled: false,\n      redirect: false\n    };\n    this.timer = 30;\n    this.handleClick = this.handleClick.bind(this);\n    this.handleGetToken = this.handleGetToken.bind(this);\n    this.handleAnswer = this.handleAnswer.bind(this);\n    this.countDown = this.countDown.bind(this);\n  }\n\n  componentDidUpdate() {\n    this.startTimer();\n  }\n\n  countDown() {\n    const _this$state = this.state,\n          time = _this$state.time,\n          answered = _this$state.answered;\n    const propSelectedAnswer = this.props.propSelectedAnswer;\n    const nextTime = time - 1;\n    this.setState({\n      time: nextTime\n    });\n\n    if (nextTime === 0) {\n      clearInterval(this.timer);\n\n      if (!answered) {\n        propSelectedAnswer(true);\n        this.setState({\n          answered: true,\n          disabled: true\n        });\n      }\n\n      this.timer = 30;\n    }\n  }\n\n  startTimer() {\n    const maxTime = 30;\n    const answered = this.state.answered;\n\n    if (this.timer === maxTime && !answered) {\n      const second = 1000;\n      this.timer = setInterval(this.countDown, second);\n    }\n  }\n\n  handleAnswer() {\n    this.setState({\n      answered: true\n    });\n  }\n\n  handleGetToken() {\n    const propQuestions = this.props.propQuestions;\n    propQuestions().then(() => this.setState({\n      loading: false\n    }));\n  }\n\n  async handleClick() {\n    const maxIndex = 4;\n    const index = this.state.index;\n    const _this$props = this.props,\n          propSetNext = _this$props.propSetNext,\n          propSelectedAnswer = _this$props.propSelectedAnswer;\n\n    if (index === maxIndex) {\n      this.setState(previousState => ({\n        index: previousState.index,\n        answered: false,\n        time: 30,\n        disabled: false,\n        redirect: true\n      }));\n    } else {\n      this.setState(previousState => ({\n        index: previousState.index + 1,\n        answered: false,\n        time: 30,\n        disabled: false\n      }));\n    }\n\n    await propSelectedAnswer(null);\n    await propSetNext();\n  }\n\n  render() {\n    const results = this.props.results;\n    const _this$state2 = this.state,\n          index = _this$state2.index,\n          loading = _this$state2.loading,\n          answered = _this$state2.answered,\n          time = _this$state2.time,\n          disabled = _this$state2.disabled,\n          redirect = _this$state2.redirect;\n    const question = results.find((_question, i) => i === index);\n    if (loading) this.handleGetToken();\n    if (redirect) return React.createElement(Redirect, {\n      to: \"/feedback\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    });\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Trivia\"), !loading && React.createElement(Question, {\n      question: question,\n      handleAnswer: this.handleAnswer,\n      disabled: disabled,\n      time: time,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      \"data-testid\": \"btn-next\",\n      type: \"button\",\n      onClick: this.handleClick,\n      hidden: !answered,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Pr\\xF3xima\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, time));\n  }\n\n}\n\ntrivia.propTypes = {\n  propQuestions: PropTypes.func\n}.isRequired;\n\nconst mapStateToProps = ({\n  actionsReducer: {\n    token,\n    results,\n    next,\n    selectedAnswer\n  }\n}) => ({\n  token,\n  results,\n  next,\n  selectedAnswer\n});\n\nconst mapDispatchToProps = dispatch => ({\n  propQuestions: () => dispatch(getQuestions()),\n  propSetNext: () => dispatch(setNext()),\n  propSelectedAnswer: selectedAnswer => dispatch(setSelectedAnswer(selectedAnswer))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(trivia);","map":{"version":3,"sources":["/home/santiago/Trybe/myprojects/sd-09-project-trivia-react-redux/src/pages/trivia.js"],"names":["React","Redirect","connect","PropTypes","Header","getQuestions","setNext","setSelectedAnswer","Question","trivia","Component","constructor","pro","state","index","loading","answered","time","disabled","redirect","timer","handleClick","bind","handleGetToken","handleAnswer","countDown","componentDidUpdate","startTimer","propSelectedAnswer","props","nextTime","setState","clearInterval","maxTime","second","setInterval","propQuestions","then","maxIndex","propSetNext","previousState","render","results","question","find","_question","i","propTypes","func","isRequired","mapStateToProps","actionsReducer","token","next","selectedAnswer","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { PropTypes } from 'prop-types';\nimport Header from '../components/header';\nimport { getQuestions, setNext, setSelectedAnswer } from '../redux/actions';\nimport Question from '../components/question';\n\nclass trivia extends React.Component {\n  constructor(pro) {\n    super(pro);\n    this.state = {\n      index: 0,\n      loading: true,\n      answered: false,\n      time: 30,\n      disabled: false,\n      redirect: false,\n    };\n    this.timer = 30;\n    this.handleClick = this.handleClick.bind(this);\n    this.handleGetToken = this.handleGetToken.bind(this);\n    this.handleAnswer = this.handleAnswer.bind(this);\n    this.countDown = this.countDown.bind(this);\n  }\n\n  componentDidUpdate() {\n    this.startTimer();\n  }\n\n  countDown() {\n    const { time, answered } = this.state;\n    const { propSelectedAnswer } = this.props;\n    const nextTime = time - 1;\n    this.setState({ time: nextTime });\n    if (nextTime === 0) {\n      clearInterval(this.timer);\n      if (!answered) {\n        propSelectedAnswer(true);\n        this.setState({ answered: true, disabled: true });\n      }\n      this.timer = 30;\n    }\n  }\n\n  startTimer() {\n    const maxTime = 30;\n    const { answered } = this.state;\n    if (this.timer === maxTime && !answered) {\n      const second = 1000;\n      this.timer = setInterval(this.countDown, second);\n    }\n  }\n\n  handleAnswer() {\n    this.setState({ answered: true });\n  }\n\n  handleGetToken() {\n    const { propQuestions } = this.props;\n    propQuestions()\n      .then(() => this.setState({ loading: false }));\n  }\n\n  async handleClick() {\n    const maxIndex = 4;\n    const { index } = this.state;\n    const { propSetNext, propSelectedAnswer } = this.props;\n    if (index === maxIndex) {\n      this.setState((previousState) => ({\n        index: previousState.index,\n        answered: false,\n        time: 30,\n        disabled: false,\n        redirect: true,\n      }));\n    } else {\n      this.setState((previousState) => ({\n        index: previousState.index + 1,\n        answered: false,\n        time: 30,\n        disabled: false,\n      }));\n    }\n    await propSelectedAnswer(null);\n    await propSetNext();\n  }\n\n  render() {\n    const { results } = this.props;\n    const { index, loading, answered, time, disabled, redirect } = this.state;\n    const question = results.find((_question, i) => i === index);\n    if (loading) this.handleGetToken();\n    if (redirect) return <Redirect to=\"/feedback\" />;\n    return (\n      <div className=\"App\">\n        <Header />\n        <h1>Trivia</h1>\n        {\n          (!loading) && <Question\n            question={ question }\n            handleAnswer={ this.handleAnswer }\n            disabled={ disabled }\n            time={ time }\n          />\n        }\n        <button\n          data-testid=\"btn-next\"\n          type=\"button\"\n          onClick={ this.handleClick }\n          hidden={ !answered }\n        >\n          Próxima\n        </button>\n        <div>\n          { time }\n        </div>\n      </div>\n    );\n  }\n}\n\ntrivia.propTypes = {\n  propQuestions: PropTypes.func,\n}.isRequired;\n\nconst mapStateToProps = ({\n  actionsReducer: { token, results, next, selectedAnswer },\n}) => ({\n  token,\n  results,\n  next,\n  selectedAnswer,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  propQuestions: () => dispatch(getQuestions()),\n  propSetNext: () => dispatch(setNext()),\n  propSelectedAnswer:\n    (selectedAnswer) => dispatch(setSelectedAnswer(selectedAnswer)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(trivia);\n"]},"metadata":{},"sourceType":"module"}